(function(o,i){typeof exports=="object"&&typeof module<"u"?i(require("@fiftyone/plugins"),require("@fiftyone/utilities"),require("@fiftyone/state"),require("react"),require("recoil")):typeof define=="function"&&define.amd?define(["@fiftyone/plugins","@fiftyone/utilities","@fiftyone/state","react","recoil"],i):(o=typeof globalThis<"u"?globalThis:o||self,i(o.__fop__,o.__fou__,o.__fos__,o.React,o.recoil))})(this,function(o,i,f,r,l){"use strict";function a(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const n in e)if(n!=="default"){const u=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,u.get?u:{enumerable:!0,get:()=>e[n]})}}return t.default=e,Object.freeze(t)}const c=a(o),m=a(i),s=a(f);class p extends r.Component{state={hasError:!1};static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,n){console.error("Uncaught error rerun panel:",t,n)}render(){return this.state.hasError?r.createElement("h1",null,"Something went wrong."):this.props.children}}const h=r.memo(({url:e})=>{const t=r.useMemo(()=>`http://localhost:9090/?url=${encodeURIComponent(e)}`,[e]);return r.createElement("iframe",{src:t,style:{width:"100%",height:"100%"}})}),d={EMBEDDED_DOC_TYPE:"fiftyone.utils.rerun.RrdFile"},E=r.memo(()=>{const e=l.useRecoilValue(s.modalSample),t=l.useRecoilValue(s.fieldSchema({space:s.State.SPACE.SAMPLE})),n=r.useMemo(()=>i.getFieldsWithEmbeddedDocType(t,d.EMBEDDED_DOC_TYPE).at(0)?.path,[t]),u=r.useMemo(()=>{if(!n||!e.urls)return;const _=e?.sample?.[n],y=s.getStandardizedUrls(e.urls)[`${n}.filepath`];return{url:s.getSampleSrc(y),version:_?.version}},[e,n]);return u?r.createElement(p,null,r.createElement(h,{url:u.url})):r.createElement("div",null,"Loading...")});c.registerComponent({name:"Rerun",label:"Rerun",component:E,activator:e=>m.doesSchemaContainEmbeddedDocType(e.schema,d.EMBEDDED_DOC_TYPE),type:c.PluginComponentType.Panel,panelOptions:{surfaces:"modal",helpMarkdown:"Rereun viewer for FiftyOne"}})});
